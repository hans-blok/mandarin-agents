{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://mandarin-agents.org/schemas/agents-publicatie-v2.json",
  "title": "Mandarin Agents Publicatie Schema v2.0",
  "description": "Vereenvoudigd schema voor de publicatie van Mandarin agents per value stream en fase met aantallen",
  "type": "object",
  "required": ["metadata", "value_streams"],
  "properties": {
    "metadata": {
      "type": "object",
      "required": ["gegenereerd_op", "versie"],
      "properties": {
        "gegenereerd_op": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp van generatie"
        },
        "versie": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+$",
          "description": "Schema versie (bijv. '2.0')"
        },
        "aantal_value_streams": {
          "type": "integer",
          "minimum": 0,
          "description": "Totaal aantal value streams"
        },
        "aantal_agents": {
          "type": "integer",
          "minimum": 0,
          "description": "Totaal aantal agents over alle value streams"
        }
      }
    },
    "value_streams": {
      "type": "array",
      "description": "Lijst van value streams met hun fasen en agents",
      "items": {
        "type": "object",
        "required": ["code", "fasen"],
        "properties": {
          "code": {
            "type": "string",
            "pattern": "^[a-z]{3}$",
            "description": "3-letter lowercase value stream code (bijv. 'aeo', 'miv', 'sfw')"
          },
          "fasen": {
            "type": "array",
            "description": "Fasen binnen deze value stream",
            "items": {
              "type": "object",
              "required": ["volgnummer", "agents"],
              "properties": {
                "volgnummer": {
                  "type": "string",
                  "pattern": "^\\d{2}$",
                  "description": "2-cijferig fasenummer (bijv. '01', '02')"
                },
                "agents": {
                  "type": "array",
                  "description": "Agents in deze fase",
                  "items": {
                    "type": "object",
                    "required": ["naam", "aantal_agent_files", "aantal_prompts", "aantal_templates", "aantal_charters"],
                    "properties": {
                      "naam": {
                        "type": "string",
                        "pattern": "^[a-z][a-z0-9-]*$",
                        "description": "Lowercase agent naam met hyphens"
                      },
                      "aantal_agent_files": {
                        "type": "integer",
                        "minimum": 0,
                        "description": "Aantal *.agent.md bestanden (contracten)"
                      },
                      "aantal_prompts": {
                        "type": "integer",
                        "minimum": 0,
                        "description": "Aantal *.prompt.md bestanden"
                      },
                      "aantal_templates": {
                        "type": "integer",
                        "minimum": 0,
                        "description": "Aantal *template*.md bestanden"
                      },
                      "aantal_charters": {
                        "type": "integer",
                        "minimum": 0,
                        "maximum": 1,
                        "description": "Aantal *.charter.md bestanden (0 of 1)"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
